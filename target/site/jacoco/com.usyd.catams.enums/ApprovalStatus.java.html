<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ApprovalStatus.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">CATAMS</a> &gt; <a href="index.source.html" class="el_package">com.usyd.catams.enums</a> &gt; <span class="el_source">ApprovalStatus.java</span></div><h1>ApprovalStatus.java</h1><pre class="source lang-java linenums">package com.usyd.catams.enums;

/**
 * Approval status enumeration for timesheet workflow management.
 * 
 * This enum defines the possible states of a timesheet through its approval lifecycle,
 * supporting the complete workflow from initial creation to final approval or rejection.
 * 
 * Based on SSOT document in docs/timesheet-approval-workflow-ssot.md
 */
<span class="fc" id="L11">public enum ApprovalStatus {</span>
    
<span class="fc" id="L13">    /**</span>
     * Initial state when timesheet is created but not yet submitted for approval.
     * Timesheet can be edited by the creator (LECTURER).
     */
<span class="fc" id="L17">    DRAFT(&quot;draft&quot;),</span>
    
    
<span class="fc" id="L20">    /**</span>
     * Timesheet has been submitted and is waiting for tutor review/confirmation.
     * Tutor can approve or request modifications.
     */
<span class="fc" id="L24">    PENDING_TUTOR_REVIEW(&quot;pending_tutor_review&quot;),</span>
    
    
<span class="fc" id="L27">    /**</span>
     * Timesheet has been approved by the tutor and is awaiting final lecturer approval.
     * Based on final workflow: TUTOR approves accuracy, then LECTURER gives final approval.
     */
<span class="fc" id="L31">    APPROVED_BY_TUTOR(&quot;approved_by_tutor&quot;),</span>
    
<span class="fc" id="L33">    /**</span>
     * Timesheet has been approved by both lecturer and tutor, ready for HR processing.
     * This status indicates academic approval is complete and HR can give final approval.
     */
<span class="fc" id="L37">    APPROVED_BY_LECTURER_AND_TUTOR(&quot;approved_by_lecturer_and_tutor&quot;),</span>
    
<span class="fc" id="L39">    /**</span>
     * Timesheet has been fully approved by HR and is ready for payroll processing.
     * This is a terminal state - no further actions allowed.
     * This is the only approved terminal state per SSOT.
     */
<span class="fc" id="L44">    FINAL_APPROVED(&quot;final_approved&quot;),</span>
    
    
<span class="fc" id="L47">    /**</span>
     * Timesheet has been rejected during the approval process.
     * Can be rejected by either tutor or HR with rejection reasons.
     * Lecturer can resubmit after making corrections.
     */
<span class="fc" id="L52">    REJECTED(&quot;rejected&quot;),</span>
    
<span class="fc" id="L54">    /**</span>
     * Timesheet requires modifications before it can proceed.
     * Returned to the creator for corrections.
     */
<span class="fc" id="L58">    MODIFICATION_REQUESTED(&quot;modification_requested&quot;);</span>

    private final String value;

<span class="fc" id="L62">    ApprovalStatus(String value) {</span>
<span class="fc" id="L63">        this.value = value;</span>
<span class="fc" id="L64">    }</span>

    public String getValue() {
<span class="fc" id="L67">        return value;</span>
    }

    /**
     * Gets the display name for UI purposes.
     * 
     * @return Human-readable status name
     */
    public String getDisplayName() {
<span class="pc bpc" id="L76" title="2 of 8 branches missed.">        switch (this) {</span>
            case DRAFT:
<span class="fc" id="L78">                return &quot;Draft&quot;;</span>
            case PENDING_TUTOR_REVIEW:
<span class="fc" id="L80">                return &quot;Pending Tutor Review&quot;;</span>
            case APPROVED_BY_TUTOR:
<span class="fc" id="L82">                return &quot;Approved by Tutor&quot;;</span>
            case APPROVED_BY_LECTURER_AND_TUTOR:
<span class="fc" id="L84">                return &quot;Approved by Lecturer and Tutor&quot;;</span>
            case FINAL_APPROVED:
<span class="fc" id="L86">                return &quot;Final Approved&quot;;</span>
            case REJECTED:
<span class="fc" id="L88">                return &quot;Rejected&quot;;</span>
            case MODIFICATION_REQUESTED:
<span class="nc" id="L90">                return &quot;Modification Requested&quot;;</span>
            default:
<span class="nc" id="L92">                return this.name();</span>
        }
    }

    /**
     * Checks if the status represents a pending state requiring action.
     * According to SSOT, only PENDING_TUTOR_REVIEW is truly &quot;pending&quot;.
     * 
     * @return true if status is pending review/approval
     */
    public boolean isPending() {
<span class="pc bpc" id="L103" title="1 of 6 branches missed.">        return this == PENDING_TUTOR_REVIEW || this == APPROVED_BY_TUTOR || this == APPROVED_BY_LECTURER_AND_TUTOR;</span>
    }

    /**
     * Checks if the status represents a terminal/final state.
     * Per SSOT, only FINAL_APPROVED and REJECTED are terminal states.
     * 
     * @return true if no further actions are allowed
     */
    public boolean isFinal() {
<span class="fc bfc" id="L113" title="All 4 branches covered.">        return this == FINAL_APPROVED || this == REJECTED;</span>
    }

    /**
     * Checks if the timesheet can be edited in this status.
     * 
     * @return true if timesheet can be modified
     */
    public boolean isEditable() {
<span class="fc bfc" id="L122" title="All 4 branches covered.">        return this == DRAFT || this == MODIFICATION_REQUESTED;</span>
    }

    /**
     * Checks if this status can transition to another status.
     * This method follows SSOT workflow transitions exactly.
     * 
     * @param targetStatus The target status to transition to
     * @return true if transition is allowed
     */
    public boolean canTransitionTo(ApprovalStatus targetStatus) {
<span class="pc bpc" id="L133" title="1 of 2 branches missed.">        if (targetStatus == null) {</span>
<span class="nc" id="L134">            return false;</span>
        }

<span class="pc bpc" id="L137" title="3 of 8 branches missed.">        switch (this) {</span>
            case DRAFT:
                // LECTURER submits for tutor review
<span class="pc bpc" id="L140" title="1 of 2 branches missed.">                return targetStatus == PENDING_TUTOR_REVIEW;</span>
                
            case PENDING_TUTOR_REVIEW:
                // TUTOR can approve, reject, or request modifications
                // Streamlined path: allow direct progression to HR queue after tutor approval
<span class="pc bfc" id="L145" title="All 2 branches covered.">                return targetStatus == APPROVED_BY_TUTOR || </span>
<span class="fc bfc" id="L146" title="All 2 branches covered.">                       targetStatus == APPROVED_BY_LECTURER_AND_TUTOR ||</span>
<span class="fc bfc" id="L147" title="All 2 branches covered.">                       targetStatus == REJECTED || </span>
<span class="pc bpc" id="L148" title="1 of 2 branches missed.">                       targetStatus == MODIFICATION_REQUESTED;</span>
                       
            case APPROVED_BY_TUTOR:
                // LECTURER gives final academic approval
<span class="fc bfc" id="L152" title="All 2 branches covered.">                return targetStatus == APPROVED_BY_LECTURER_AND_TUTOR;</span>
                
            case APPROVED_BY_LECTURER_AND_TUTOR:
                // HR can give final approval or reject, or request modification back to lecturer
<span class="pc bfc" id="L156" title="All 2 branches covered.">                return targetStatus == FINAL_APPROVED || </span>
<span class="pc bpc" id="L157" title="1 of 2 branches missed.">                       targetStatus == REJECTED ||</span>
<span class="pc bpc" id="L158" title="1 of 2 branches missed.">                       targetStatus == MODIFICATION_REQUESTED;</span>
                       
            case MODIFICATION_REQUESTED:
                // LECTURER resubmits after corrections
<span class="pc bpc" id="L162" title="1 of 2 branches missed.">                return targetStatus == PENDING_TUTOR_REVIEW;</span>
                
            case REJECTED:
                // TUTOR edits and resubmits (starts new cycle)
<span class="nc bnc" id="L166" title="All 2 branches missed.">                return targetStatus == PENDING_TUTOR_REVIEW;</span>
                
            case FINAL_APPROVED:
<span class="nc" id="L169">                return false; // Terminal state - no further transitions</span>
                
            default:
<span class="nc" id="L172">                return false;</span>
        }
    }

    /**
     * Parse status from string value (legacy support).
     * 
     * @param value The string value to parse
     * @return The corresponding ApprovalStatus
     * @throws IllegalArgumentException if value is invalid
     */
    public static ApprovalStatus fromValue(String value) {
<span class="nc bnc" id="L184" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L185">            throw new IllegalArgumentException(&quot;Approval status value cannot be null&quot;);</span>
        }
        
<span class="nc bnc" id="L188" title="All 2 branches missed.">        for (ApprovalStatus status : values()) {</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">            if (status.getValue().equals(value)) {</span>
<span class="nc" id="L190">                return status;</span>
            }
        }
        
<span class="nc" id="L194">        throw new IllegalArgumentException(&quot;Invalid approval status value: &quot; + value);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>