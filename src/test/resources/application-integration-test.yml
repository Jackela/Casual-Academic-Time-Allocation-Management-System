# Integration Test Configuration
# Used with TestContainers for realistic database testing

spring:
  # Database configuration (overridden by TestContainers)
  datasource:
    url: jdbc:postgresql://localhost:5432/catams_test
    username: test_user
    password: test_password
    driver-class-name: org.postgresql.Driver
    
  # JPA Configuration
  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: false
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true
        
  # Security Configuration
  security:
    jwt:
      secret: dGVzdC1zZWNyZXQtZm9yLWludGVncmF0aW9uLXRlc3RzLW11c3QtYmUtYXQtbGVhc3QtMjU2LWJpdHM=
      expiration: 3600000 # 1 hour for testing
      
  # Logging Configuration
  logging:
    level:
      com.usyd.catams: DEBUG
      org.springframework.security: WARN
      org.hibernate: WARN
      com.zaxxer.hikari: WARN
      org.testcontainers: INFO
      
  # Disable DevTools for integration tests
  devtools:
    restart:
      enabled: false
      
# Test-specific configuration
test:
  performance:
    # Performance test thresholds (milliseconds)
    response-time:
      auth: 500        # Authentication endpoints
      crud: 200        # CRUD operations
      list: 300        # List operations with pagination
      search: 400      # Search operations
    
    # Load testing configuration
    concurrent-users: 10
    test-duration: 30s
    warmup-duration: 5s
    
  database:
    # Reset database between test classes
    cleanup: true
    
  security:
    # Test-specific security settings
    disable-csrf: true
    allow-test-tokens: true

# Management and Monitoring
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized
  metrics:
    export:
      simple:
        enabled: true