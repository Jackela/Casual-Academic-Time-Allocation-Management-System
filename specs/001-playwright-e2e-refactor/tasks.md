---description: "Task list template for feature implementation"---# Tasks: Refactor CATAMS Playwright E2E (frontend/e2e/real)**Input**: Design documents from /specs/001-playwright-e2e-refactor/**Prerequisites**: plan.md (required), spec.md (required for user stories), research.md, data-model.md, contracts/**Tests**: This feature is the E2E test suite itself. Tasks below implement/refactor E2E specs and helpers.**Organization**: Tasks are grouped by user story to enable independent implementation and testing of each story.## Format: [ID] [P?] [Story] Description- **[P]**: Can run in parallel (different files, no dependencies)- **[Story]**: Which user story this task belongs to (e.g., US1, US2, US3)- Include exact file paths in descriptions## Path Conventions- **Web app**: frontend/e2e/real/ for this feature## Phase 1: Setup (Shared Infrastructure)- [x] T001 Create unified Page Object base in \frontend/e2e/real/pages/base.page.ts- [x] T002 [P] Add programmatic login helper in \frontend/e2e/real/utils/login.ts- [x] T003 [P] Create selector helpers using data-testid in \frontend/e2e/real/utils/selectors.ts- [x] T004 Configure Playwright project for Chromium-only in \frontend/e2e/real/playwright.config.ts- [x] T005 Add tags and reporter config in \frontend/e2e/real/playwright.config.ts (HTML report on fail)- [x] T024 [P] Add OpenAPI response assertion helper in frontend/e2e/real/utils/contract.ts---## Phase 2: Foundational (Blocking Prerequisites)- [x] T006 Remove obsolete Tutor self-creation specs from \frontend/e2e/real/specs/ and related pages- [x] T007 [P] Consolidate Page Objects: LecturerDashboardShell in \frontend/e2e/real/pages/lecturer.dashboard.page.ts- [x] T008 [P] Consolidate Page Objects: AdminUsersPage in \frontend/e2e/real/pages/admin.users.page.ts- [x] T009 [P] Ensure required data-testid attributes exist; if missing, create TODO list in \frontend/e2e/real/fixtures/missing-testids.md---## Phase 3: User Story 1 - Lecturer creates timesheet (Priority: P0) ðŸŽ¯ MVP**Goal**: Lecturer creates timesheet successfully with SSOT compliance**Independent Test**: Run only US1 spec; verify success confirmation and server-calculated fields; no financial fields sent by client### Implementation for User Story 1- [x] T010 [P] [US1] Create US1 spec in \frontend/e2e/real/specs/lecturer-create-timesheet.spec.ts- [x] T011 [US1] Implement Page Object methods for create flow in \frontend/e2e/real/pages/lecturer.dashboard.page.ts- [x] T012 [US1] Add SSOT payload assertion helper in \frontend/e2e/real/utils/ssot.ts- [x] T013 [US1] Add quote-on-change assertion in \frontend/e2e/real/specs/lecturer-create-timesheet.spec.ts- [x] T023 [US1] Submit invalid inputs and assert inline field errors in frontend/e2e/real/specs/lecturer-create-timesheet.spec.ts- [x] T025 [US1] Assert response fields match OpenAPI in frontend/e2e/real/specs/lecturer-create-timesheet.spec.ts (use utils/contract.ts)---## Phase 4: User Story 2 - Tutor restricted (Priority: P0)**Goal**: Tutor cannot access creation; receives restriction message and redirect if deep-linked**Independent Test**: Run only US2 spec; verify absence of creation UI and presence of clear restriction message### Implementation for User Story 2- [x] T014 [P] [US2] Create US2 spec in \frontend/e2e/real/specs/tutor-restricted.spec.ts- [x] T015 [US2] Add route guard assertions in \frontend/e2e/real/specs/tutor-restricted.spec.ts---## Phase 5: User Story 3 - Full approval chain (Priority: P0)**Goal**: Draft â†’ Tutor Confirm â†’ Lecturer Approve â†’ Admin Approve; enforce admin-after-lecturer invariant**Independent Test**: Run only US3 spec; verify each status change and final approval; include negative bypass attempt### Implementation for User Story 3- [x] T016 [P] [US3] Create US3 spec in \frontend/e2e/real/specs/approval-chain.spec.ts- [x] T017 [US3] Add negative case: admin approval blocked before lecturer approval in \frontend/e2e/real/specs/approval-chain.spec.ts- [x] T026 [US3] Assert status semantics per OpenAPI during approvals (409 and success codes) in frontend/e2e/real/specs/approval-chain.spec.ts---## Phase 6: User Story 4 - Modification & rejection (Priority: P1)**Goal**: Show in-app banner + badge with reason for modification and rejection**Independent Test**: Run only US4 spec; verify banner+badge and reason text visibility### Implementation for User Story 4- [x] T018 [P] [US4] Create US4 spec in \frontend/e2e/real/specs/modification-rejection.spec.ts- [x] T019 [US4] Update Page Objects for banner/badge selectors in \frontend/e2e/real/pages/*.ts---## Phase 7: User Story 5 - Admin user management (Priority: P1)**Goal**: Create user, enforce password policy, activate/deactivate lifecycle**Independent Test**: Run only US5 spec; verify validation messages and successful state changes### Implementation for User Story 5- [x] T020 [P] [US5] Create US5 spec in \frontend/e2e/real/specs/admin-user-management.spec.ts- [x] T021 [US5] Implement creation flow with validation messages (password policy) in \frontend/e2e/real/specs/admin-user-management.spec.ts- [x] T022 [US5] Implement activate/deactivate assertions in \frontend/e2e/real/specs/admin-user-management.spec.ts---## Phase N: Polish & Cross-Cutting Concerns- [x] T090 [P] Update \frontend/e2e/real/fixtures/missing-testids.md with resolved items and linked PRs- [x] T091 [P] Add JSDoc to helpers in \frontend/e2e/real/utils/*.ts** - [x] T092 Ensure Playwright HTML report and traces on failure are enabled in \frontend/e2e/real/playwright.config.ts- [x] T093 Flake audit: remove retries where stable; document any residual flake in \frontend/e2e/real/fixtures/flake-log.md- [x] T094 Record real E2E runtime in CI and include duration in PR description---## Dependencies & Execution Order- Setup (Phase 1) â†’ Foundational (Phase 2) â†’ US1 (P0) â†’ US2 (P0) â†’ US3 (P0) â†’ US4 (P1) â†’ US5 (P1) â†’ Polish### User Story Dependencies- US1 has no dependency on US2/US3/US4/US5- US3 depends on ability to create + confirm; implement after US1- US4 and US5 independent of each other; both after Foundational### Parallel Opportunities- [P] tasks in Setup and Foundational can run concurrently- US1: T010, T013 parallel after POM exists- US4: T018 and T019 in parallel- US5: T021 and T022 in parallel## Implementation Strategy- MVP First: Complete US1 then stop and validate- Incremental Delivery: Add US2 and US3; then P1 stories (US4, US5)



