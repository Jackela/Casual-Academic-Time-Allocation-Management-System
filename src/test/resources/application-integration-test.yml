# Integration Test Profile (test-only overrides)
# Purpose: Minimal configuration overrides for integration tests using Testcontainers
# Database configuration is handled via @DynamicPropertySource in IntegrationTestBase

spring:
  datasource:
    url: jdbc:tc:postgresql:15:///catams
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver  
    # Let Flyway manage schema - disable Hibernate DDL
  flyway:
    enabled: true
    
  # JPA Configuration for integration tests  
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    
  # Security Configuration (test JWT secret)
  security:
    jwt:
      secret: dGVzdC1zZWNyZXQtZm9yLWludGVncmF0aW9uLXRlc3RzLW11c3QtYmUtYXQtbGVhc3QtMjU2LWJpdHM=
      expiration: 3600000
      
  # Disable Spring Boot DevTools for tests
  devtools:
    restart:
      enabled: false

# Logging Configuration (test-appropriate levels)
logging:
  level:
    com.usyd.catams: DEBUG
    org.springframework.security: WARN
    org.hibernate: WARN
    com.zaxxer.hikari: WARN
    org.testcontainers: INFO

# Management endpoints (minimal for testing)
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized

app:
  testing:
    reset-token: test-reset-token
